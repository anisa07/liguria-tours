---
import IntlBaseLayout from "@/layouts/IntlBaseLayout.astro";
import { getPageTranslations } from "@/i18n/i18n";
import { defaultLocale, type Locale } from "@/i18n/config";
import { getEntry } from "astro:content";
import Container from "@/components/layout/Container.astro";
import Hero from "@/components/content/Hero.astro";
import ItalianToursGallery from "@/components/content/ItalianToursGallery.astro";
import CallToAction from "@/components/content/CallToAction.astro";
import { getCollection } from "astro:content";

// Set locale to Russian
const locale: Locale = defaultLocale;

// Get the translation function for this page
const { t } = await getPageTranslations(locale, ["common", "ui", "home"]);

const ctaActions = [
  {
    label: t("actions.book_now", "Забронировать тур"),
    href: "/contact",
    variant: "primary" as const,
  },
  {
    label: t("actions.contact", "Узнать больше"),
    href: "/contact",
    variant: "outline" as const,
  },
];

const heroEntry = await getEntry("hero", "hero");
const heroData = heroEntry?.data;

const toursEntry = await getCollection("italianToursGallery");
const italianToursGalleryData = toursEntry && toursEntry[0]?.data;
---

<IntlBaseLayout
  locale={locale}
  pageNS={["common", "ui", "home"]}
  seo={{
    title: t(
      "seo.title",
      "TechFlow - Modern Development Platform | Build the Future",
    ),
    description: t(
      "seo.description",
      "Streamline your development workflow with our powerful, secure, and scalable platform. Join 10M+ developers building the future with TechFlow.",
    ),
  }}
>
  <!-- Hero Section -->
  {
    heroData && (
      <Hero
        title={heroData.title}
        mainTitle={heroData.mainTitle}
        subtitle={heroData.subtitle}
        description={heroData.description}
        actions={[
          {
            label: t("actions.book_now", "Забронировать"),
            href: "/contact",
            variant: "primary" as const,
          },
        ]}
        galleryImages={heroData.images}
        class="animate-fade-in"
      />
    )
  }

  <!-- Italian Tours Gallery -->
  {
    italianToursGalleryData && (
      <ItalianToursGallery
        locale={locale}
        italianToursGalleryData={italianToursGalleryData.tours}
      />
    )
  }

  <!-- CTA Section -->
  <section class="py-20 relative overflow-hidden">
    <div
      class="absolute inset-0 bg-gradient-to-b from-transparent to-primary/20"
    >
    </div>
    <Container size="lg" padding="lg" class="relative z-10">
      <CallToAction
        title={t("cta.title", "Ready to Transform Your Workflow?")}
        subtitle={t("cta.subtitle", "Join 10M+ developers building the future")}
        description={t(
          "cta.description",
          "Свяжитесь со мной сегодня, и я помогу вам спланировать идеальную экскурсию по Лигурии.",
        )}
        actions={ctaActions}
        backgroundColor="neutral"
        class="animate-fade-up"
        variant="centered"
      />
    </Container>
  </section>
</IntlBaseLayout>

<style>
  section {
    border: none;
  }
</style>
