---
import IntlBaseLayout from "@/layouts/IntlBaseLayout.astro";
import Container from "@/components/layout/Container.astro";
import BoatTourDetails from "@/components/content/BoatTourDetails.astro";
import CallToAction from "@/components/content/CallToAction.astro";
import { getPageTranslations, getLocaleStaticPaths } from "@/i18n/i18n";
import type { Locale } from "@/i18n/config";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  return getLocaleStaticPaths();
}

const { locale } = Astro.params as { locale: Locale };

// Get the translation function for this page
const { t } = await getPageTranslations(locale, ["common", "ui", "tours"]);

const pageTitle = t("sea_tours.title", "Морская прогулка");
const pageDescription = t(
  "sea_tours.description",
  "Отправьтесь в морское путешествие из Генуи по живописному побережью Леванте. Прогулка на катере, уютные города и дегустация лёгких вин у моря.",
);

// Load boat tours from content collection
const boatToursCollection = await getCollection("boatTourCollection");
const boatToursData = boatToursCollection && boatToursCollection[0]?.data;
const allBoatTours = boatToursData?.tours || [];

// CTA actions
const ctaActions = [
  {
    label: t("sea_tours.cta.book", "Забронировать прогулку"),
    href: "/about-me",
    variant: "primary" as const,
  },
  {
    label: t("sea_tours.cta.details", "Узнать подробности"),
    href: "#details",
    variant: "outline" as const,
  },
];
---

<IntlBaseLayout title={pageTitle} description={pageDescription} locale={locale}>
  <!-- Sea Tours Section -->
  <section
    id="sea-tours"
    class="py-20 relative overflow-hidden bg-gradient-to-br from-muted/30 via-tertiary/20 to-tertiary/40"
  >
    <!-- Wave Pattern Background -->
    <div class="absolute inset-0 opacity-10">
      <svg
        class="w-full h-full"
        viewBox="0 0 1200 800"
        xmlns="http://www.w3.org/2000/svg"
      >
        <defs>
          <pattern
            id="wave-pattern"
            x="0"
            y="0"
            width="120"
            height="40"
            patternUnits="userSpaceOnUse"
          >
            <path
              d="M0,20 Q30,0 60,20 T120,20"
              stroke="currentColor"
              stroke-width="2"
              fill="none"
              opacity="0.3"></path>
          </pattern>
        </defs>
        <rect width="100%" height="100%" fill="url(#wave-pattern)"></rect>
      </svg>
    </div>

    <Container size="xl" class="relative z-10">
      <!-- Section Header -->
      <div class="text-center mb-16">
        <h1 class="text-4xl md:text-6xl font-bold mb-4 text-primary">
          {t("sea_tours.title", "Морская прогулка на катере")}
        </h1>
        <div class="max-w-4xl mx-auto space-y-4">
          <h2 class="text-xl text-muted-foreground leading-relaxed">
            Совместно с <span class="font-semibold text-primary"
              >Консорциумом «Тигуллио»</span
            > — морские маршруты, остановки в прибрежных городках и дегустация вин
            у моря.
          </h2>
        </div>
      </div>

      <div class="space-y-8">
        {
          allBoatTours.map((tour) => (
            <BoatTourDetails tour={tour} carouselId={tour.id} />
          ))
        }
      </div>
    </Container>
  </section>

  <!-- Call to Action -->
  <CallToAction
    title={t("sea_tours.cta.title", "Готовы к морскому приключению?")}
    description={t(
      "sea_tours.cta.description",
      "Забронируйте морскую прогулку и увидьте Лигурию с совершенно новой стороны",
    )}
    actions={ctaActions}
    variant="centered"
    backgroundColor="primary"
    size="sm"
  />
</IntlBaseLayout>
