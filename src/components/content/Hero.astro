---
import { getPageTranslations } from "@/i18n/i18n";
import type { Locale } from "@/i18n/config";
import { ChevronDown } from "@lucide/astro";
import HeroGallery from "./HeroGallery.astro";
import HeroText from "./HeroText.astro";
import Container from "@/components/layout/Container.astro";
import type { ImageMetadata } from "astro";

export interface HeroAction {
  label: string;
  href: string;
  variant?: "primary" | "secondary" | "outline";
  external?: boolean;
  icon?: string;
}

export interface Props {
  title: string;
  mainTitle: string;
  subtitle?: string;
  description?: string;
  actions?: HeroAction[];
  galleryImages?: Array<{
    image: ImageMetadata;
    alt: string;
    title: string;
    description: string;
  }>;
  class?: string;
  locale?: Locale;
}

const {
  subtitle = "",
  description,
  actions = [],
  galleryImages = [],
  class: className = "",
  locale = "ru",
  mainTitle,
} = Astro.props;

// Get translations
const { t } = await getPageTranslations(locale, ["hero", "common"]);
---

<section class="relative border-none">
  <!-- Gradient Background -->
  <div
    class="absolute inset-0 bg-gradient-to-b from-primary/20 to-transparent rounded-b-[150px]"
  >
  </div>

  <Container size="xl" padding="lg">
    <div
      class="relative z-10 gap-8 md:gap-16 items-center min-h-screen py-20 flex flex-col w-full"
    >
      <!-- Top Side - Content -->
      <div
        class="text-foreground/80 text-center flex flex-col items-center gap-8"
      >
        <h1 class="text-4xl md:text-6xl font-bold mb-4">
          {mainTitle}
        </h1>

        <!-- {
      subtitle && (
        <h2 class="inline-block px-4 py-2 bg-secondary backdrop-blur-md rounded-full text-sm font-medium shadow-md">
          {subtitle}
        </h2>
      )
    } -->
      </div>

      <!-- Down Side - Gallery Preview -->
      <div class="relative flex flex-col gap-6 w-full items-start">
        <!-- Tour Info and Gallery Row -->
        <div class="flex flex-col md:flex-row gap-4 w-full items-start">
          <HeroText
            locale={locale}
            title={subtitle}
            description={description}
            actions={actions}
          />
          <div class="w-full md:w-2/3 lg:1/2 flex flex-col">
            <HeroGallery galleryImages={galleryImages} locale={locale} />
          </div>
        </div>
      </div>
    </div>

    <!-- Scroll Indicator -->
    <div
      class="absolute bottom-8 left-1/2 transform -translate-x-1/2 animate-bounce bg-primary rounded-full z-20"
    >
      <button
        type="button"
        id="scroll-down-btn"
        class="inline-flex items-center justify-center w-10 h-10 text-background hover:text-primary-foreground transition-colors"
        aria-label={t("hero.scroll_down", "Прокрутить вниз")}
      >
        <ChevronDown class="w-6 h-6" />
      </button>
    </div>
  </Container>
</section>

<script is:inline>
  // Scroll down functionality
  const scrollDownBtn = document.getElementById("scroll-down-btn");
  if (scrollDownBtn) {
    scrollDownBtn.addEventListener("click", function () {
      window.scrollTo({
        top: window.innerHeight,
        behavior: "smooth",
      });
    });
  }
</script>

<style>
  /* Smooth scroll behavior */
  html {
    scroll-behavior: smooth;
  }

  /* Focus styles for action buttons */
  .focus\:ring-primary:focus {
    --tw-ring-color: rgb(var(--color-primary) / var(--tw-ring-opacity));
  }

  .focus\:ring-secondary:focus {
    --tw-ring-color: rgb(var(--color-secondary) / var(--tw-ring-opacity));
  }
</style>
